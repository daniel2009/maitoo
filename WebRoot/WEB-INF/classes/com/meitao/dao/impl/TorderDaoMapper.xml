<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><mapper namespace="com.meitao.dao.TorderDao">	<resultMap id="basic_result_map" type="com.meitao.model.T_order">		<id column="id" property="id" javaType="String" />		<result column="t_order_id" property="torderId" javaType="String"/>		<result column="user_id" property="userId" javaType="String"/>		<result column="totalmoney" property="totalmoney" javaType="String"/>		<result column="totalcost" property="totalcost" javaType="String"/>		<result column="weight" property="weight" javaType="String"/>		<result column="sjweight" property="sjweight" javaType="String"/>		<result column="other" property="other" javaType="String"/>		<result column="quantity" property="quantity" javaType="String"/>		<result column="tariff" property="tariff" javaType="String"/>		<result column="value" property="value" javaType="String"/>		<result column="insurance" property="insurance" javaType="String"/>		<result column="remark" property="remark" javaType="String"/>		<result column="channelId" property="channelId" javaType="String"/>		<result column="storeId" property="storeId" javaType="String"/>		<result column="employeeId" property="employeeId" javaType="String"/>		<result column="create_date" property="createDate" javaType="String"/>		<result column="modify_date" property="modifyDate" javaType="String"/>		<result column="ruserId" property="ruserId" javaType="String"/>		<result column="state" property="state" javaType="String"/>		<result column="qremark" property="qremark" javaType="String"/>		<result column="order_ids" property="order_ids" javaType="String"/>		<result column="type" property="type" javaType="String"/>		<result column="i_state" property="i_state" javaType="String"/>		<result column="i_employeeId" property="i_employeeId" javaType="String"/>		<result column="i_storeId" property="i_storeId" javaType="String"/>		<result column="i_date" property="i_date" javaType="String"/>		<result column="i_jwweight" property="i_jwweight" javaType="String"/>		<result column="i_weight" property="i_weight" javaType="String"/>		<result column="positionId" property="positionId" javaType="String"/>		<result column="payway" property="payway" javaType="String"/>		<result column="tremark" property="tremark" javaType="String"/>				  <association property="user" column="user_id"			select="com.meitao.dao.UserDao.getUserById"></association>		<association property="ruser" column="ruserId"			select="com.meitao.dao.Receive_UserDao.getById"></association>					<association property="position" column="positionId"			select="com.meitao.dao.Shelves_positionDao.getbyid"></association>		<!-- <association property="route" column="id"			select="com.meitao.dao.TrouteDao.getRouteByTid"></association> -->	</resultMap>			<insert id="insertyb" parameterType="com.meitao.model.T_order"		useGeneratedKeys="true" keyProperty="id">		insert into		`t_order`(`t_order_id`,`user_id`,`type`,`state`,		`remark`,`create_date`,		`modify_date`)		values(#{torderId},#{userId},#{type},#{state},		#{remark},		#{createDate},		#{modifyDate})	</insert>	<select id="countOfftorder" resultType="java.lang.Integer">		select count(distinct `t_order`.`id`) 		from `t_order`		<where>	   		`t_order`.`t_order_id`=#{torderId} 		   <if test="userId!=null and userId!=''">				and `t_order`.`user_id` = #{userId}		   </if>	   </where>	</select>		<select id="countOfSearchTordersbyuser" resultType="java.lang.Integer">		select count(distinct `t_order`.id) 		from `t_order`		<where>					<if test="userId!=null and userId!=''">				`t_order`.`user_id` = #{userId} 			</if>			<if test="state!=null and state!=''">				and `t_order`.`state` = #{state} 			</if>			<if test="keyword!=null and keyword!=''">				and (`t_order`.`remark` like #{keyword} or `t_order`.`t_order_id` like #{keyword} or `t_order`.`order_ids` like #{keyword} or `t_order`.`qremark` like #{keyword} or `t_order`.`tremark` like #{keyword})			</if>		</where>	</select>	<select id="SearchTordersbyuser" resultMap="basic_result_map">		select distinct `t_order`.*		from `t_order`		<where>					<if test="userId!=null and userId!=''">				`t_order`.`user_id` = #{userId} 			</if>			<if test="state!=null and state!=''">				and `t_order`.`state` = #{state} 			</if>			<if test="keyword!=null and keyword!=''">				and (`t_order`.`remark` like #{keyword} or `t_order`.`t_order_id` like #{keyword} or `t_order`.`order_ids` like #{keyword} or `t_order`.`qremark` like #{keyword} or `t_order`.`tremark` like #{keyword})			</if>		</where>		order by `t_order`.`create_date` desc		limit		#{index},#{size}	</select><select id="countOfSearchTordersbyuser1" resultType="java.lang.Integer">		select count(distinct `t_order`.id) 		from `t_order`		<where>					<if test="userId!=null and userId!=''">				`t_order`.`user_id` = #{userId} 			</if>			<if test="state!=null and state!=''">				and `t_order`.`state` = #{state} 			</if>			<if test="storeId!=null and storeId!=''">				and `t_order`.`storeId` = #{storeId} 			</if>			<if test="i_storeId!=null and i_storeId!=''">				and `t_order`.`i_storeId` = #{i_storeId} 			</if>			<if test="keyword!=null and keyword!=''">				and (`t_order`.`remark` like #{keyword} or `t_order`.`t_order_id` like #{keyword} or `t_order`.`order_ids` like #{keyword} or `t_order`.`qremark` like #{keyword} or `t_order`.`tremark` like #{keyword})			</if>		</where>	</select>	<select id="SearchTordersbyuser1" resultMap="basic_result_map">		select distinct `t_order`.*		from `t_order`		<where>					<if test="userId!=null and userId!=''">				`t_order`.`user_id` = #{userId} 			</if>			<if test="state!=null and state!=''">				and `t_order`.`state` = #{state} 			</if>			<if test="storeId!=null and storeId!=''">				and `t_order`.`storeId` = #{storeId} 			</if>			<if test="i_storeId!=null and i_storeId!=''">				and `t_order`.`i_storeId` = #{i_storeId} 			</if>			<if test="keyword!=null and keyword!=''">				and (`t_order`.`remark` like #{keyword} or `t_order`.`t_order_id` like #{keyword} or `t_order`.`order_ids` like #{keyword} or `t_order`.`qremark` like #{keyword} or `t_order`.`tremark` like #{keyword})			</if>		</where>		order by `t_order`.`create_date` desc		limit		#{index},#{size}	</select>	<delete id="deleteone">		DELETE FROM t_order		<where>			`t_order`.`id` = #{id} and state='0'			<if test="userId!=null and userId!=''">				and `t_order`.`user_id` = #{userId} 			</if>		</where>	</delete>		<delete id="deleteonebyadmin">		DELETE FROM t_order		where `t_order`.`id` = #{id}	</delete>	<select id="getone" parameterType="java.lang.String" resultMap="basic_result_map">		select * from t_order		<where>			`t_order`.`id` = #{id}			<if test="userId!=null and userId!=''">				and `t_order`.`user_id` = #{userId} 			</if>		</where>	</select>		<select id="getonebyadmin" parameterType="java.lang.String" resultMap="basic_result_map">		select * from t_order		<where>			`t_order`.`id` = #{id}			<if test="storeId!=null and storeId!=''">				and (`t_order`.`storeId` = #{storeId} or `t_order`.`i_storeId` = #{storeId})			</if>		</where>	</select>		<select id="gettorders" parameterType="java.lang.String" resultMap="basic_result_map">		select * from t_order		<where>			<if test="storeId!=null and storeId!=''">				and `t_order`.`storeId` = #{storeId} 			</if>			<if test="state!=null and state!=''">				and `t_order`.`state` = #{state} 			</if>			<if test="torderId!=null and torderId!=''">				and `t_order`.`t_order_id` = #{torderId} 			</if>		</where>	</select>		<!-- 修改转运单号 -->	<update id="modify_zy_torder">		update`t_order`		set		`weight`=#{weight},		`sjweight`=#{sjweight},		`employeeId`=#{employeeId},		`storeId`=#{storeId},		`modify_date`=#{modifyDate},		`state`=#{state},		`type`=#{type},		`positionId`=#{positionId}		where id=#{id}	</update>			<!-- 修改转运单号 -->	<update id="modify_state">		update`t_order`		set `t_order`.`state`=#{state},		`t_order`.`modify_date`=#{modifyDate}		<where>		 	`t_order`.`t_order_id`=#{torderId}		 	<if test="storeId!=null and storeId!=''">				and `t_order`.`storeId` = #{storeId} 			</if>			<if test="pre_state!=null and pre_state!=''">				and `t_order`.`state` in				<foreach collection="pre_state" item="states" open="(" close=")"					separator=",">					${states}				</foreach> 			</if>		 </where>	</update>				<select id="gettordersbyprestate" parameterType="java.lang.String" resultMap="basic_result_map">		select * from t_order		<where>		 	`t_order`.`t_order_id`=#{torderId}		 	<if test="storeId!=null and storeId!=''">				and `t_order`.`storeId` = #{storeId} 			</if>			<if test="pre_state!=null and pre_state!=''">				and `t_order`.`state` in				<foreach collection="pre_state" item="states" open="(" close=")"					separator=",">					${states}				</foreach> 			</if>		 </where>	</select>			<!-- 更改状态 -->	<update id="modifystatebyId">		update`t_order`		set `state`=#{state},		`modify_date`=#{modifyDate}		<if test="orderids!=null and orderids!=''">			,`order_ids`=#{orderids}		</if>		<if test="tremark!=null">			,`tremark`=#{tremark}		</if>		where id=#{id}	</update>		<!-- 获取运单-->	<select id="gettordersbystore" parameterType="java.lang.String" resultMap="basic_result_map">		select * from t_order		<where>		 	`t_order`.`t_order_id`=#{torderId}		 	<if test="storeId!=null and storeId!=''">				and `t_order`.`storeId` = #{storeId} 			</if>			<if test="states!=null and states!=''">				and `t_order`.`state` in				<foreach collection="states" item="state1" open="(" close=")"					separator=",">					${state1}				</foreach> 			</if>			<if test="type!=null and type!=''">				and `t_order`.`type` = #{type} 			</if>		 </where>	</select>					<!-- 本地入库 -->	<update id="modify_local_in_torder">		update`t_order`		set `i_weight`=#{i_weight},		`i_jwweight`=#{i_jwweight},		`i_employeeId`=#{i_employeeId},		`i_storeId`=#{i_storeId},		`modify_date`=#{modifyDate},		`i_date`=#{i_date},		`state`=#{state},		`type`=#{type},		`positionId`=#{positionId}		where id=#{id}	</update>						<insert id="insertfail" parameterType="com.meitao.model.T_order"		useGeneratedKeys="true" keyProperty="id">		insert into		`t_order`(`t_order_id`,`user_id`,`type`,`state`,		`remark`,`create_date`,		`modify_date`,`qremark`,`storeId`,`employeeId`,`weight`,`sjweight`,`positionId`)		values(#{torderId},#{userId},#{type},#{state},		#{remark},		#{createDate},		#{modifyDate},#{qremark},#{storeId},#{employeeId},#{weight},#{sjweight},#{positionId})	</insert>		<insert id="insert_zyinlogcal_fail_torder" parameterType="com.meitao.model.T_order"		useGeneratedKeys="true" keyProperty="id">		insert into		`t_order`(`t_order_id`,`user_id`,`type`,`state`,		`remark`,`create_date`,		`modify_date`,`qremark`,`storeId`,`employeeId`,`i_weight`,`i_jwweight`,`positionId`,`i_state`,`i_employeeId`,`i_storeId`)		values(#{torderId},#{userId},#{type},#{state},		#{remark},		#{createDate},		#{modifyDate},#{qremark},#{storeId},#{employeeId},#{i_weight},#{i_jwweight},#{positionId},#{i_state},#{i_employeeId},#{i_storeId})	</insert>			<insert id="insert_local_fail_torder" parameterType="com.meitao.model.T_order"		useGeneratedKeys="true" keyProperty="id">		insert into		`t_order`(`t_order_id`,`user_id`,`type`,`state`,		`remark`,`create_date`,		`modify_date`,`qremark`,`i_weight`,`i_jwweight`,`positionId`,`i_state`,`i_employeeId`,`i_storeId`)		values(#{torderId},#{userId},#{type},#{state},		#{remark},		#{createDate},		#{modifyDate},#{qremark},#{i_weight},#{i_jwweight},#{positionId},#{i_state},#{i_employeeId},#{i_storeId})	</insert>				<select id="getstatecount" resultType="java.lang.Integer">		select count(distinct `t_order`.id) 		from `t_order` 		<where>		 	<if test="userId!=null and userId!=''">				`t_order`.`user_id` = #{userId} 			</if>			<if test="state!=null and state!=''">				and `t_order`.`state` = #{state} 			</if>		</where>	</select>					<!-- 修改录入失败转运单号归属于用户 -->	<update id="modify_fail_torder">		update`t_order`		set `t_order`.`state`=#{state},		`t_order`.`modify_date`=#{modifyDate},		`t_order`.`remark`=#{remark},		`t_order`.`qremark`=#{qremark},		`t_order`.`user_id`=#{userId}		where id=#{id}	</update>							<!-- 后台修改状态 -->	<update id="modify_state_torder">		update`t_order`		set 		`t_order`.`modify_date`=#{modifyDate},		<if test="state!=null and state!=''">			`t_order`.`state`=#{state},		</if>		`t_order`.`qremark`=#{qremark}		where id=#{id}	</update>			<select id="countOfSearchTordersbyadmin" resultType="java.lang.Integer">		select count(distinct `t_order`.id) 		from `t_order`		left join `shelves_position` as s		on s.id=`t_order`.positionId		left join `users` as u		on u.id=`t_order`.user_id		<where>			<if test="storeId!=null and storeId!=''">				`t_order`.`storeId` = #{storeId} 			</if>			<if test="i_storeId!=null and i_storeId!=''">				`t_order`.`i_storeId` = #{i_storeId} 			</if>			<if test="payway!=null and payway!=''">				<!--  and `t_order`.`payway` = #{payway} -->			</if>						<if test="s_cdate!=null and s_cdate!=''">				and `t_order`.`create_date` <![CDATA[>=]]>				#{s_cdate}			</if>			<if test="e_cdate!=null and e_cdate!=''">				and `t_order`.`create_date` <![CDATA[<=]]>				#{e_cdate}			</if>			<if test="s_idate!=null and s_idate!=''">				and `t_order`.`i_date` <![CDATA[>=]]>				#{s_idate}			</if>			<if test="e_idate!=null and e_idate!=''">				and `t_order`.`i_date` <![CDATA[<=]]>				#{e_idate}			</if>			<if test="payway!=null and payway!=''">				and `t_order`.`payway` = #{payway} 			</if>						<if test="state!=null and state!=''">				and `t_order`.`state` = #{state} 			</if>			<if test="keyword!=null and keyword!=''">				and (`t_order`.`remark` like #{keyword} or `t_order`.`t_order_id` like #{keyword} or `t_order`.`order_ids` like #{keyword} or `t_order`.`qremark` like #{keyword} or `t_order`.`tremark` like #{keyword}				or s.position like #{keyword} or u.email like #{keyword} or u.phone like #{keyword} or u.nick_name like #{keyword} or u.real_name like #{keyword})			</if>			<if test="s_storeId!=null and s_storeId!=''">				and (`t_order`.`storeId` = #{s_storeId} or `t_order`.`i_storeId` = #{s_storeId} or `t_order`.`state`='0')			</if>		</where>	</select>	<select id="SearchTordersbyadmin" resultMap="basic_result_map">		select distinct `t_order`.*		from `t_order`		left join `shelves_position` as s		on s.id=`t_order`.positionId		left join `users` as u		on u.id=`t_order`.user_id		<where>			<if test="storeId!=null and storeId!=''">				`t_order`.`storeId` = #{storeId} 			</if>			<if test="i_storeId!=null and i_storeId!=''">				`t_order`.`i_storeId` = #{i_storeId} 			</if>			<if test="payway!=null and payway!=''">				<!--  and `t_order`.`payway` = #{payway} -->			</if>						<if test="s_cdate!=null and s_cdate!=''">				and `t_order`.`create_date` <![CDATA[>=]]>				#{s_cdate}			</if>			<if test="e_cdate!=null and e_cdate!=''">				and `t_order`.`create_date` <![CDATA[<=]]>				#{e_cdate}			</if>			<if test="s_idate!=null and s_idate!=''">				and `t_order`.`i_date` <![CDATA[>=]]>				#{s_idate}			</if>			<if test="e_idate!=null and e_idate!=''">				and `t_order`.`i_date` <![CDATA[<=]]>				#{e_idate}			</if>			<if test="payway!=null and payway!=''">				and `t_order`.`payway` = #{payway} 			</if>			<if test="state!=null and state!=''">				and `t_order`.`state` = #{state} 			</if>			<if test="keyword!=null and keyword!=''">				and (`t_order`.`remark` like #{keyword} or `t_order`.`t_order_id` like #{keyword} or `t_order`.`order_ids` like #{keyword} or `t_order`.`qremark` like #{keyword} or `t_order`.`tremark` like #{keyword}				or s.position like #{keyword} or u.email like #{keyword} or u.phone like #{keyword} or u.nick_name like #{keyword} or u.real_name like #{keyword})			</if>			<if test="s_storeId!=null and s_storeId!=''">				and (`t_order`.`storeId` = #{s_storeId} or `t_order`.`i_storeId` = #{s_storeId} or `t_order`.`state`='0')			</if>		</where>		order by `t_order`.`create_date` desc		limit		#{index},#{size}	</select>						<!-- 清空占用的仓位 -->	<update id="clear_positionId">		update`t_order`		set		`modify_date`=#{modifyDate},		`positionId`='0'		where positionId=#{positionId}	</update>						<!-- 修改转运单号 -->	<update id="modify_paybyself_torder">		update`t_order`		set		`i_weight`=#{i_weight},		`i_jwweight`=#{i_jwweight},		`qremark`=#{qremark},		`state`=#{state},		`modify_date`=#{modifyDate},		`totalmoney`=#{totalmoney},		`totalcost`=#{totalcost},		`payway`=#{payway}		where id=#{id}	</update>		</mapper>