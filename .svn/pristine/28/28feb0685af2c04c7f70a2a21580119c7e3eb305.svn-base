<%@ page language="java" contentType="text/html; charset=UTF-8"	pageEncoding="UTF-8"%><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>print</title><link rel="shortcut icon" href="../img/favicon.ico" /></head><body>	<div class="print" style="width=650px;color:#000000;">		<div>			<table border=1 bordercolor=#000000 id="print_table1" style="font-size:10px;">				<tr style="text-align:center;height:50px;">					<td  colspan=5  width=35% style="font-size:20px;"><span >国际快件</span>									</td>					<td colspan=2 width=35% style="font-size:14px">US258转运全球</td>					<td width=30%><div							style="margin-left: 1px;margin-right: 1px; margin-top: 1px;margin-bottom:1px; ">							<img id="qrcodeurl" style="height:45px;" src="" />						</div></td>					</tr>				<tr >					<td colspan=5  >					网址：&nbsp;<span							id="print_site_url"  style="font-size:9px"></span>							</td>					<td colspan=3 rowspan="2"><img						name="barcode" id="barcode" style="width:99%; height:35px;"						src="${pageContext.request.contextPath }/barcode4j/generate?msg=${param.orderId }&type=code39&height=12" /></td>									</tr>				<tr >					<td colspan=5 >电话:&nbsp;<span id="usa_phone" style="font-size:9px;"></span></td>				</tr>				<tr style="height:15px;">					<td  rowspan="3" valign="middle" align="center" style="width:20px">						收<br/>件<br/>人												</td>					<td colspan=7 valign="top" style="height:30px;">地址：&nbsp;<span name="cAddress1" style="font-size:9px;">&nbsp;</span>&nbsp;</span>						<span name="cAddress2" style="font-size:9px;;"></td>								</tr>				<tr >					<td colspan=5 >公司：</td>										<td colspan=2>目的地：<span name="cAddress3_1" style="font-size:9px;">&nbsp;</span></td>								</tr>								<tr >				<td colspan=5 >电话：<span name="cPhone" style="font-size:9px;">&nbsp;</span></td>										<td colspan=2>重量：<span						name="weight" style="font-size:9px;">&nbsp;</span></td>								</tr>				<tr >											<td rowspan=3 valign="middle" align="center">发<br/>件<br/>人					</td>							<td colspan=5 rowspan="2" valign="top" style="width: 597px; ">地址：<span	name="from_address" style="font-size:9px;"></td>		<td colspan="2" >日期：<span name="send_date" style="font-size:9px;">&nbsp;</span></td>				</tr>				<tr >																		<td style="width: 323px; ">保险：<span						name="prenim" style="font-size:9px;">&nbsp;</span></td><td style="width: 330px; ">其他：<span						name="other" style="font-size:9px;">&nbsp;</span></td>				</tr>									<tr >																		<td colspan=5 >电话：<span name="phone" style="font-size:9px;">&nbsp;</span></td><td >体积：</td><td >关税： <span						name="duties" style="font-size:9px;">&nbsp;</span></td>				</tr>										<tr >																		<td colspan="6" valign="top">始发地：<span						name="warehouseAddress" style="font-size:9px;">&nbsp;</span></td><td colspan="2">目的地：<span name="cAddress3_2" style="font-size:9px;">&nbsp;</span></td>				</tr>		<tr >																		<td colspan="7"><img						name="barcode" id="barcode" style="width:99%; height:35px;"						src="${pageContext.request.contextPath }/barcode4j/generate?msg=${param.orderId }&type=code39&height=12" /></td><td colspan="1">收件提示：请务必检查无误后签收</td>				</tr>						<tr style="height:60px">																		<td colspan="8" valign="top">内件详情：<div name="remark" style="margin-left: 30px;font-size:9px;"></div></td>				</tr>					<tr style="height:45px">																		<td colspan="8"><img						name="barcode" id="barcode" style="width:99%; height:35px;"						src="${pageContext.request.contextPath }/barcode4j/generate?msg=${param.orderId }&type=code39&height=12" /></td>				</tr>				</table>				</div>				<!-- <div>			<table border=1 id="print_table1">				<tr height="100px">					<td width=35%>						<div							style="float: left;margin-left: 3px;text-align: center;width:98%;">							<div>								<img src="../img/index/logo.png" /> <span>#</span>							</div>						</div></td>					<td width=40% style="text-align: center;"><img name="barcode"						style="width:98%; height:60%;"						src="${pageContext.request.contextPath }/barcode/generate?code=${param.orderId }" />						<span name="order_id" style="font-size:14pt;">&nbsp;</span></td>					<td width=25% style="text-align: center;"><span						style="font-size: 12pt;">626-898-7996 美国</span> <br /> <span						style="font-size: 12pt;">189-1885-3038 中国</span></td>				</tr>			</table> 		</div> -->	</div>	<div id="param_div" style="display: none;">		<input type="hidden" value="${param.id }" name="p_oid" /> 		 		<!-- <input			type="hidden"			value="${pageContext.request.contextPath }/barcode/generate?code="			name="barcodeimg" />  -->	</div>	<input type="hidden" value="${param.orderId }" name="orderId_or" /></body><script type="text/javascript">	//kai 20150911-1 modify	//js获取项目根路径，如： http://localhost:8083/uimcardprj	base_url_set_has_sub = false;	function getRootPath() {		// 获取当前网址，如： http://localhost:8083/uimcardprj/share/meun.jsp		var curWwwPath = window.document.location.href;		// 获取主机地址之后的目录，如： uimcardprj/share/meun.jsp		var pathName = window.document.location.pathname;		var pos = curWwwPath.indexOf(pathName);		// 获取主机地址，如： http://localhost:8083		var localhostPaht = curWwwPath.substring(0, pos);		// 获取带"/"的项目名，如：/uimcardprj		var projectName = pathName.substring(0,				pathName.substr(1).indexOf('/') + 1);		if (base_url_set_has_sub == true) {			return (localhostPaht + projectName);		} else {			return localhostPaht;		}	}	$(document)			.ready(					//这里再次生成条形码是为了确保能够正学显示					function() {					//alert();			//	setTimeout(window.print(), 500);					//return false;						var orderid1=$(":hidden[name='orderId_or']").val();																								//alert(orderid1);						$.ajax({							type : "get",							url : "../barcode4j/generate",							data : {								msg : orderid1,								type:"code39",								height:"12"							},							success : function(response) {								//alert("6565");								setTimeout("printA4()",300);//							}});											});	function getglobalargs() {		//var flags="print_logo_flag,print_order_hit,print_site_url";//获取logo图片,包裹提示,网站的url		var flags = "print_order_hit,print_site_url";//获取logo图片,包裹提示,网站的url		$.ajax({			type : "post",			url : admin_globalargs_getcontents_url,			data : {				"flags" : flags			},			success : function(response) {				var code = response.code;				if ("200" == code) {					if (response.data != null) {						/*if((response.data[0]=="")||(response.data[0]=="null")||(response.data[0]=="undefined")||(response.data[0]==null))						{													}						else						{														//$("#print_logo").attr("src",getRootPath()+response.data[0]);							//$("#print_logo2").attr("src",getRootPath()+response.data[0]);						}*/						if ((response.data[0] == "")								|| (response.data[0] == "null")								|| (response.data[0] == "undefined")								|| (response.data[0] == null)) {						} else {							$("#print_order_hit").html(response.data[0]);						}						if ((response.data[1] == "")								|| (response.data[1] == "null")								|| (response.data[1] == "undefined")								|| (response.data[1] == null)) {						} else {							//$("#print_site_url").html(response.data[1]);							//$("#print_site_url2").html(response.data[1]);							if($("#print_site_url").html()=="")							{								$("#print_site_url").html(response.data[1]);							}														if($("#print_site_url2").html()=="")							{								$("#print_site_url2").html(response.data[1]);							}						}					} else {					}				} else {				}				$(document).ready(function() {					setTimeout(window.print(), 500);				});			}		});	}			function printA4()	{		function transformer(value) {			if (value == null || value == '') {				return "&nbsp;";			}			return value;		}		function string2int(value) {			if (value == null || value == '') {				return 0;			}			return parseInt(value);		}		$("#my_print_div")				.ready(						function() {							var id = $(":hidden[name='p_oid']").val();							var orderid= $(":hidden[name='orderId_or']").val();																							$									.ajax({										type : "get",										url : admin_order_get_one_url,										data : {											"id" : id,											"oid":orderid										},										success : function(												response) {											var code = response.code;											if ("200" == code) {												var data = response.data;												var orderId = data.orderId;												var orderid1=$(":hidden[name='orderId_or']").val();												if(orderId!=orderid1)//传过来的是id,要重新打印条形码												{													var str11="${pageContext.request.contextPath }/barcode4j/generate?msg="+orderId+"&type=code39&height=12";																									//alert("465654");														//alert(orderid1);														$("#barcode2").attr("src",str11);														$("#barcode").attr("src",str11);														$.ajax({															type : "get",															url : "../barcode4j/generate",															data : {																msg : orderId,																type:"code39",																height:"12"															},															success : function(response) {																//alert("6565");																//setTimeout("printA4()",300);//															}});																																							}																																			/*	if (orderId == null														|| orderId == '') {													orderId = transformer(id);												}*/												var toAddress = "";												if(removenull(data.cProvince)!="")												{													toAddress += transformer(data.cProvince)															+ "&nbsp;/";												}																								if(removenull(data.cCity)!="")												{													toAddress += transformer(data.cCity)														+ "&nbsp;/";												}																								if(removenull(data.cDistrict)!="")												{												toAddress += transformer(data.cDistrict)														+ "&nbsp;/";												}												toAddress += transformer(data.cStreetAddress);												//$("#print_table1 div[name='to_address']").html(toAddress);												var cAddress1 = "";												var cAddress3="";												if(removenull(data.cProvince)!="")												{												cAddress1 += transformer(data.cProvince)														+ " ";												cAddress3+= transformer(data.cProvince)														+ " ";												}												if(removenull(data.cCity)!="")												{													cAddress1 += transformer(data.cCity)														+ " ";													cAddress3 += transformer(data.cCity)														+ " ";												}												if(removenull(data.cDistrict)!="")												{													cAddress1 += transformer(data.cDistrict)														+ " ";												}																																				$(														"#print_table1 span[name='cAddress3_1']")														.html(																cAddress3);												$(														"#print_table1 span[name='cAddress3_2']")														.html(																cAddress3);												$(														"#print_table1 span[name='order_id']")														.html(																orderId);												//$("#print_table1 img[name='barcode']").attr("src", $(":hidden[name='barcodeimg']").val() + orderId);												$(														"#print_table1 span[name='receiver']")														.html(																transformer(data.cName)																		+ "/"																		+ transformer(data.cPhone)																		+ "/"																		+ toAddress);												//kai 20150918 如果是代理会员，取地址要取自地址表												if ((data.user != null)														&& (data.user.type == "5")) {													//alert(transformer(data.senduserphone));													$(															"#print_table1 span[name='phone']")															.html(																	transformer(data.senduserphone));													$(															"#print_table1 span[name='from_address']")															.html(																	transformer(data.senduserAddress));												} else if (data.user == null) {													$(															"#print_table1 span[name='phone']")															.html(																	transformer(data.senduserphone));													$(															"#print_table1 span[name='from_address']")															.html(																	transformer(data.senduserAddress));												} else {													$(															"#print_table1 span[name='phone']")															.html(																	transformer(data.user.phone));													$(															"#print_table1 span[name='from_address']")															.html(																	transformer(data.user.address));												}if(removenull(data.newdate)==""){	$("#print_table1 span[name='send_date']").html(transformer(data.createDate));}else{	$("#print_table1 span[name='send_date']").html(transformer(data.newdate));}																								$(														"#print_table1 span[name='cPhone']")														.html(																transformer(data.cPhone));												$(														"#print_table1 span[name='cName']")														.html(																transformer(data.cName));												$(														"#print_table1 span[name='zip_code']")														.html(																transformer(data.cZipCode));												$(														"#print_table1 span[name='cAddress1']")														.html(																transformer(cAddress1));												$(														"#print_table1 span[name='cAddress2']")														.html(																transformer(data.cStreetAddress));												//kai 20150918 修改，如果用户是代理会员，发件人数据取自运单表												if ((data.user != null)														&& (data.user.type == "5")) {													//alert(transformer(data.senduserName));													$(															"#print_table1 span[name='from_user']")															.html(																	transformer(data.senduserName));												} else if (data.user == null) {													$(															"#print_table1 span[name='from_user']")															.html(																	transformer(data.senduserName));												} else {													if(removenull(data.senduserName)!="")													{														$("#print_table1 span[name='from_user']").html(transformer(data.senduserName));													}													else													{													$(															"#print_table1 span[name='from_user']")															.html(																	/*transformer(data.user.nickName)																			+ "/"																			+ transformer(data.user.realName)																			+ "#"																			+ transformer(data.user.id)*/																			transformer(data.user.realName)																			);													}												}												//$("#print_table1 label[name='company']").html("&nbsp;");												//$("#print_table1 label[name='zip_code']").html(transformer(data.cZipCode));												//var userId = data.userId;												var fromAddress = data.warehouseId;												//var warehouseid ="";												$(														"#print_table1 span[name='warehouseid']")														.html(																fromAddress);												var qty = 0;												var remark = transformer(data.remark)														+ "";												var str_remark = "";												var listflag=0;												$														.each(																data.details,																function() {																listflag=1;																	str_remark += this.xiangqing																			+ "*"																			+ this.quantity																			+ ";";																	qty = qty																			+ string2int(this.quantity);																});												/*var remarkprint = "商品详情("														+ qty														+ "):<br/>"														+ str_remark														+ "<br\>备注:"														+ remark;*/													var remarkprint =														str_remark														+ "<br\>备注:"														+ remark;														if(listflag==1)														{															/*$("#print_table1 div[name='remark']")																	.html(remarkprint);*/														}														else														{															/*$("#print_table1 div[name='remark']")																	.html(data.commodityThirdList);*/														}												var remarkprint = "<br\>"														+ remark;												$(														"#print_table1 div[name='remark2']")														.html(																remarkprint);												$(														"#print_table1 label[name='customs_value']")														.html(																transformer(data.parceValue));												$(														"#print_table1 span[name='qty']")														.html(																qty);												$(														"#print_table1 span[name='duties']")														.html(																data.tariff);												if ((data.jwweight == null)														|| (data.jwweight == "null")														|| (data.jwweight == "0")														|| (data.jwweight == "")) {													$(															"#print_table1 span[name='weight']")															.html(																	data.weight);												} else {													$(															"#print_table1 span[name='weight']")															.html(																	data.jwweight);												}																								var weightKg=data.weightKg;												if(removenull(weightKg)==null)												{													weightKg="";												}												else												{													if(parseFloat(weightKg)==0||isNaN(weightKg))													{														weightKg="";													}												}												$("#print_table1 span[name='weightKg']").html(weightKg);																																				$(														"#print_table1 span[name='other']")														.html(																data.other);												$(														"#print_table1 span[name='parceValue']")														.html(																transformer(data.parceValue));												//$("#print_table1 span[name='or']").html(data.or);																								var state1=parseFloat(data.state);												var totalMoney=data.totalMoney;												if(isNaN(state1))												{													//totalMoney=0;												}												else												{													if(state1<2)													{														totalMoney=0													}												}																								$(														"#print_table1 span[name='total_money']")														.html(																totalMoney);												$(														"#print_table1 span[name='prenim']")														.html(																data.premium);												var volume = parseFloat(data.length														* data.width														* data.height														/ 166);												var f_x = Math														.round(volume * 100) / 100;												var s_x = f_x														.toString();												var pos_decimal = s_x														.indexOf('.');												if (pos_decimal < 0) {													pos_decimal = s_x.length;													s_x += '.';												}												while (s_x.length <= pos_decimal + 2) {													s_x += '0';												}												$(														"#print_table1 span[name='volume']")														.html(																s_x);												//$("#print_table1 label[name='total_money']").html(data.totalMoney);												//$("#print_table1 label[name='weight']").html(data.weight);												$														.ajax({															async : true,															type : "get",															url : admin_warehouse_get_one_url,															data : {																"id" : data.warehouseId															},															success : function(																	response) {																var code = response.code;																if ("200" == code) {																	if (response.data != null																			|| response.data != "") {																		/*$(																				"#print_table1 span[name='warehouseAddress']")																				.html(																						response.data.address);*/																																				$("#print_table1 span[name='warehouseAddress']").html(removenull(response.data.address)+"<br/>&nbsp;&nbsp;"+removenull(response.data.city)+"&nbsp;"+removenull(response.data.province)+"&nbsp;"+removenull(response.data.country)+"&nbsp;"+removenull(response.data.zipCode));																																																																								var url = response.data.print2Code;																		if ((url == "")																				|| (url == null)																				|| (url == "null")																				|| (url == "undefined")) {																			$(																					"#qrcodeurl")																					.attr(																							"src",																							"");																			$(																					"#qrcodeurl2")																					.attr(																							"src",																							"");																		} else {																			url = getRootPath()																					+ url;																			//alert(url);																			$(																					"#qrcodeurl")																					.attr(																							"src",																							url);																			$(																					"#qrcodeurl2")																					.attr(																							"src",																							url);																		}																		if ((response.data.printPhoneUSA == "")																				|| (response.data.printPhoneUSA == "null")																				|| (response.data.printPhoneUSA == null)																				|| (response.data.printPhoneUSA == "undefined")) {																			$(																					"#usa_phone")																					.html(																							"");																			$(																					"#usa_phone2")																					.html(																							"");																		} else {																			$(																					"#usa_phone")																					.html(																							""																									+ response.data.printPhoneUSA);																			$(																					"#usa_phone2")																					.html(																							""																									+ response.data.printPhoneUSA);																		}																		if ((response.data.printPhoneCN == "")																				|| (response.data.printPhoneCN == "null")																				|| (response.data.printPhoneCN == null)																				|| (response.data.printPhoneCN == "undefined")) {																			$(																					"#china_phone")																					.html(																							"");																			$(																					"#china_phone2")																					.html(																							"");																		} else {																			$(																					"#china_phone")																					.html(																							"中国："																									+ response.data.printPhoneCN);																			$(																					"#china_phone2")																					.html(																							"中国："																									+ response.data.printPhoneCN);																		}																	}																	//logo处理																	if ((response.data.printLogo == "")																			|| (response.data.printLogo == "null")																			|| (response.data.printLogo == "undefined")																			|| (response.data.printLogo == null)) {																	} else {																		$(																				"#print_logo")																				.attr(																						"src",																						getRootPath()																								+ response.data.printLogo);																		$(																				"#print_logo2")																				.attr(																						"src",																						getRootPath()																								+ response.data.printLogo);																	}																																																			if(removenull(response.data.printUrl)!="")																	{																		$("#print_site_url").html(response.data.printUrl);																		$("#print_site_url2").html(response.data.printUrl);																	}																																		//window.print();																	//getglobalargs();																	setTimeout("getglobalargs()", 600);																} else {																	alert("获取仓库信息失败!");																}															}														});												$("#param_div")														.html(																"&nbsp;");											} else {												alert("获取运单信息失败，无法打印运单！");											}											return false;										}									});						});	}</script></html>